{{ define "main" }}
  {{ $data := .Site.Data.page }}
  <section class="hero" id="top">
    {{ partial "galaxy.html" . }}
    <div class="container hero-grid" style="position: relative; z-index: 1;">
      <div class="hero-copy">
        <p class="hero-kicker">{{ $data.hero.kicker }}</p>
        <h1><span class="text-gradient">{{ $data.hero.title }}</span></h1>
        <p class="hero-description">{{ $data.hero.description }}</p>
        <div class="hero-actions">
          <a class="btn primary" href="{{ $data.hero.primary_cta.url }}">{{ $data.hero.primary_cta.text }}</a>
          <a class="btn secondary" href="{{ $data.hero.secondary_cta.url }}" target="_blank" rel="noopener">{{ $data.hero.secondary_cta.text }}</a>
        </div>
      </div>
      <div class="galaxy-placeholder"></div>
    </div>
  </section>


  <section class="feature-section" id="workflow">
    <div class="container feature-grid">
      {{ range $data.features }}
      <article class="feature-card">
        <h3>{{ .title }}</h3>
        <p>{{ .description }}</p>
      </article>
      {{ end }}
    </div>
  </section>

  <section class="snippets" id="snippets">
    <div class="container">
      <div class="section-intro">
        <p class="section-kicker">Explore the workflow</p>
        <h2>End-to-end code snippets</h2>
        <p class="section-description">Swipe through runnable examples that mirror the glyco-omics journey from raw measurements to pathway reconstruction.</p>
      </div>
      <div class="snippet-carousel" data-snippet-carousel>
        <button class="carousel-arrow prev" type="button" aria-label="Scroll snippets backward">
          <span aria-hidden="true">&#8592;</span>
        </button>
        <div class="snippet-track" role="region" aria-label="Glycoverse workflow code snippets">
          <article class="snippet-card">
            <h3>Data Loading and Preprocessing</h3>
            {{ highlight "# Support mainstream software\nexp <- read_pglyco3(\"results.txt\")\n\n# Automatic preprocessing\nclean_exp <- auto_clean(exp)" "r" "" }}
          </article>
          <article class="snippet-card">
            <h3>Differential Expression Analysis</h3>
            {{ highlight "# ANOVA\ngly_anova(clean_exp)\n\n# Limma\ngly_limma(clean_exp)" "r" "" }}
          </article>
          <article class="snippet-card">
            <h3>GO Enrichment</h3>
            {{ highlight "# Unified function API\ngo_res <- gly_enrich_go(clean_exp)\n\n# Automatic visualization\nautoplot(go_res)" "r" "" }}
          </article>
          <article class="snippet-card">
            <h3>Motif Quantification and DEA</h3>
            {{ highlight "# Advanced motif analysis\nmotif_exp <- quantify_motifs(clean_exp, \"Lewis X\")\n\n# Ready for statistical analysis\ngly_kruskal(motif_exp)" "r" "" }}
          </article>
          <article class="snippet-card">
            <h3>Derived Traits and DEA</h3>
            {{ highlight "# Site-specific derived traits\ntrait_exp <- derive_traits(clean_exp)\n\n# Again, a smooth pipeline\ngly_kruskal(trait_exp)" "r" "" }}
          </article>
          <article class="snippet-card">
            <h3>Re-build Biosynthesis Pathway</h3>
            {{ highlight "# Any glycan structure string\nglycan <- \"Gal(b1-3)[GlcNAc(b1-6)]GalNAc(a1-\"\n\n# Get biosynthesis insights\nrebuild_biosynthesis(glycan)" "r" "" }}
          </article>
        </div>
        <button class="carousel-arrow next" type="button" aria-label="Scroll snippets forward">
          <span aria-hidden="true">&#8594;</span>
        </button>
      </div>
    </div>
    <script>
      (function () {
        var carousels = document.querySelectorAll('[data-snippet-carousel]');
        if (!carousels.length) return;
        carousels.forEach(function (carousel) {
          var track = carousel.querySelector('.snippet-track');
          var prev = carousel.querySelector('.carousel-arrow.prev');
          var next = carousel.querySelector('.carousel-arrow.next');
          if (!track || !prev || !next) return;
          var scrollByAmount = function () {
            return track.clientWidth * 0.9;
          };
          prev.addEventListener('click', function () {
            track.scrollBy({ left: -scrollByAmount(), behavior: 'smooth' });
          });
          next.addEventListener('click', function () {
            track.scrollBy({ left: scrollByAmount(), behavior: 'smooth' });
          });
        });
      })();
    </script>
  </section>

  <section class="packages" id="packages">
    <div class="container">
      <div class="section-intro">
        <p class="section-kicker">Meet the packages</p>
        <h2>A coordinated toolkit for glycan discovery</h2>
        <p class="section-description">Modular building blocks cover the journey from raw glyco-omics measurements to annotated glycan structures.</p>
      </div>
      {{ range $section := $data.sections }}
      <div class="package-section" id="{{ $section.id }}">
        <div class="package-header">
          <h3>{{ $section.title }}</h3>
          <p>{{ $section.description }}</p>
        </div>
        <div class="package-grid">
          {{ range $pkg := $section.packages }}
          <article class="package-card">
            <div class="package-card-header">
              <img src="{{ printf "images/logos/%s.png" (lower $pkg.name) | relURL }}" alt="{{ $pkg.name }} logo">
              <div>
                <h4>{{ $pkg.name }}</h4>
                <p class="package-tagline">{{ $pkg.tagline }}</p>
              </div>
            </div>
            <p class="package-description">{{ $pkg.description }}</p>
            <div class="package-actions">
              <a class="btn tertiary" href="{{ $pkg.docs }}" target="_blank" rel="noopener">Docs</a>
              <a class="btn link" href="{{ $pkg.github }}" target="_blank" rel="noopener">GitHub</a>
            </div>
          </article>
          {{ end }}
        </div>
      </div>
      {{ end }}
    </div>
  </section>
{{ end }}
